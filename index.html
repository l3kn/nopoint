<html>
  <head>
  <title>nopoint</title>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
    <script type="text/javascript" src="showdown.js"></script>
    <script type="text/javascript" src="../prettify/prettify.js"></script>
    <script type="text/javascript" src="../prettify/lang-css.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet" type="text/css" href="../prettify/prettify.css">
  </head>
  <body>
    <div class="container"></div>
    <div class="count"></div>    
  </body>
</html>
<script>
  var current_slide = 0;
  var converter = new Showdown.converter();
  var slides = new Array();

 	$.ajax({
    url: 'slide.md',
    async: false, 
    cache: false,   // stuff will change
    success: function(data) 
    {
      var converted = converter.makeHtml(data);
      slides = converted.split('<hr />');
    }
  });

  if(isNaN(window.location.search.substr(1)) != 1) // ?slidenum
  {
    var num = parseInt(window.location.search.substr(1));
    if(num <= slides.length && num != 0)
      current_slide = parseInt(window.location.search.substr(1))-1; 
  }

  function loadSlide ()
  {
	  $('.container').html(slides[current_slide]);
    var string = 'Slide ' + (current_slide+1) + ' of ' + slides.length
    $('.count').html('<p>' +  string + '</p>');
    prettyPrint();
  }
  function toggleFullscreen() 
  {
    var element = document.getElementsByTagName("body")[0];
   
    if (element.requestFullScreen) {
   
      if (!document.fullScreen) {
        element.requestFullscreen();
      } else {
        document.exitFullScreen();
      }
   
    } else if (element.mozRequestFullScreen) {
   
      if (!document.mozFullScreen) {
        element.mozRequestFullScreen();
      } else {
        document.mozCancelFullScreen();
      }
   
    } else if (element.webkitRequestFullScreen) {
   
      if (!document.webkitIsFullScreen) {
        element.webkitRequestFullScreen();
      } else {
        document.webkitCancelFullScreen();
      }
    }
  }
  loadSlide();
	$(document).keydown(function(e){
    if (e.keyCode == 37) {
    	if (current_slide>0) { // show alert
    		current_slide--;
    		loadSlide();
    	}
      return false;
    }
    else if (e.keyCode == 38) {
      toggleFullscreen();
      return false;
    }    
    else if (e.keyCode == 39) {
    	if (current_slide < slides.length-1) {
    		current_slide++;
    		loadSlide();
    	}
      return false;
    }
    else if (e.keyCode == 40) {
        current_slide = 0;
        loadSlide();
      return false;
    }    
	});  
</script>